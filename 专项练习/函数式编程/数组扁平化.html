<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>

  <script>
    // Array.prototype.flatten = function () {
    //   var _arr = this,
    //     toStr = {}.toString;

    //   if (toStr.call(_arr) !== '[object Array]') {
    //     throw new Error('只有数组可以使用该方法');
    //   }
    //   var fArr = [];

    //   _arr.forEach(function (elem) {
    //     toStr.call(elem) === '[object Array]' ? fArr = fArr.concat(elem.flatten()) : fArr.push(elem);
    //   });
    //   return fArr;
    // }

    const arr = [1, , 2, [3, , 4, [5, 6], 7], 8, 9];

    Array.prototype.flatten = function () {
      var _arr = this,
        toStr = {}.toString;

      if (toStr.call(_arr) !== '[object Array]') {
        throw new Error('只有数组可以使用该方法');
      }

      return _arr.reduce(function (prev, elem) {
        return prev.concat(
          toStr.call(elem) === '[object Array]' ? elem.flatten() : elem
        )
      }, [])
    }

    console.log(arr.flatten());
  </script>
</body>

</html>